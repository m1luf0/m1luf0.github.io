<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="视频地址:https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;cKxRvEZd3Mw 以下内容基于Python3,视频还是Python2.7 运行环境: PyCharm2019 [TOC] 你好,世界(决策树分类器)决策树分类器   123456from sklearn import treefeatures &#x3D; [[140,1],[130,1],[150,1],[170,0]]# 特">
<meta property="og:type" content="article">
<meta property="og:title" content="Google机器学习讲座笔记">
<meta property="og:url" content="https://m1luf0.github.io/2020/01/14/Google%20ML/index.html">
<meta property="og:site_name" content="m1luf0">
<meta property="og:description" content="视频地址:https:&#x2F;&#x2F;www.youtube.com&#x2F;watch?v&#x3D;cKxRvEZd3Mw 以下内容基于Python3,视频还是Python2.7 运行环境: PyCharm2019 [TOC] 你好,世界(决策树分类器)决策树分类器   123456from sklearn import treefeatures &#x3D; [[140,1],[130,1],[150,1],[170,0]]# 特">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404101048.png">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404101300.png">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404112032.png">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404165703.png">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404172720.png">
<meta property="og:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200405192724.png">
<meta property="article:published_time" content="2020-01-13T19:14:12.000Z">
<meta property="article:author" content="m1luf0">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Google">
<meta property="article:tag" content="Notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404101048.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Google机器学习讲座笔记</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/m1luf0">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2020/01/14/100-Days-Of-ML-Code-1/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2020/01/10/NLPwithpython/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://m1luf0.github.io/2020/01/14/Google%20ML/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&text=Google机器学习讲座笔记"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&is_video=false&description=Google机器学习讲座笔记"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Google机器学习讲座笔记&body=Check out this article: https://m1luf0.github.io/2020/01/14/Google%20ML/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&name=Google机器学习讲座笔记&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://m1luf0.github.io/2020/01/14/Google%20ML/&t=Google机器学习讲座笔记"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E5%A5%BD-%E4%B8%96%E7%95%8C-%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">你好,世界(决策树分类器)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96-%E9%B8%A2%E5%B0%BE%E8%8A%B1iris%E8%B5%84%E6%96%99%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">决策树的可视化(鸢尾花iris资料集)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E4%BC%98%E7%A7%80%E7%89%B9%E5%BE%81"><span class="toc-number">3.</span> <span class="toc-text">何为优秀特征</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E4%BB%AC%E5%86%99%E4%B8%80%E4%B8%AA%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%B5%81%E6%B0%B4%E7%BA%BF%E5%90%A7%EF%BC%81-k%E8%BF%91%E9%82%BB%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">让我们写一个机器学习流水线吧！(k近邻分类器)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">我们的第一个分类器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8TensorFlow-for-Poets-%E8%AE%AD%E7%BB%83%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">使用TensorFlow for Poets 训练图像分类器</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Google机器学习讲座笔记
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">m1luf0</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-01-13T19:14:12.000Z" class="dt-published" itemprop="datePublished">2020-01-14</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Machine-Learning/">Machine Learning</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Google/" rel="tag">Google</a>, <a class="p-category" href="/tags/Notes/" rel="tag">Notes</a>, <a class="p-category" href="/tags/Python/" rel="tag">Python</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>视频地址:<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=cKxRvEZd3Mw">https://www.youtube.com/watch?v=cKxRvEZd3Mw</a></p>
<p>以下内容基于Python3,视频还是Python2.7</p>
<p>运行环境: PyCharm2019</p>
<p>[TOC]</p>
<h2 id="你好-世界-决策树分类器"><a href="#你好-世界-决策树分类器" class="headerlink" title="你好,世界(决策树分类器)"></a>你好,世界(决策树分类器)</h2><p>决策树分类器</p>
<img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404101048.png" style="zoom:50%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line">features = [[<span class="number">140</span>,<span class="number">1</span>],[<span class="number">130</span>,<span class="number">1</span>],[<span class="number">150</span>,<span class="number">1</span>],[<span class="number">170</span>,<span class="number">0</span>]]<span class="comment"># 特征</span></span><br><span class="line">labels = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]<span class="comment">#标签</span></span><br><span class="line">clf = tree.DecisionTreeClassifier()<span class="comment">#决策树分类器</span></span><br><span class="line">clf = clf.fit(features, labels)<span class="comment">#训练分类器</span></span><br><span class="line"><span class="built_in">print</span>(clf.predict([[<span class="number">160</span>,<span class="number">0</span>]]))<span class="comment">#预测结果</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404101300.png" style="zoom:50%;" />

<h2 id="决策树的可视化-鸢尾花iris资料集"><a href="#决策树的可视化-鸢尾花iris资料集" class="headerlink" title="决策树的可视化(鸢尾花iris资料集)"></a>决策树的可视化(鸢尾花iris资料集)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"></span><br><span class="line">iris = load_iris()</span><br><span class="line"><span class="built_in">print</span>(iris.feature_names)  <span class="comment"># [&#x27;sepal length (cm)&#x27;, &#x27;sepal width (cm)&#x27;, &#x27;petal length (cm)&#x27;, &#x27;petal width (cm)&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(iris.target_names)  <span class="comment"># [&#x27;setosa&#x27; &#x27;versicolor&#x27; &#x27;virginica&#x27;]</span></span><br><span class="line"><span class="built_in">print</span>(iris.data[<span class="number">0</span>])  <span class="comment"># [ 5.1  3.5  1.4  0.2]</span></span><br><span class="line"><span class="built_in">print</span>(iris.target[<span class="number">0</span>])  <span class="comment"># 0</span></span><br><span class="line">test_idx = [<span class="number">0</span>, <span class="number">50</span>, <span class="number">100</span>]  <span class="comment"># 取0,50，100作为测试集</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># training data</span></span><br><span class="line">train_target = np.delete(iris.target, test_idx)</span><br><span class="line">train_data = np.delete(iris.data, test_idx, axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># testing data</span></span><br><span class="line">test_target = iris.target[test_idx]</span><br><span class="line">test_data = iris.data[test_idx]</span><br><span class="line"></span><br><span class="line">clf = tree.DecisionTreeClassifier()</span><br><span class="line">clf = clf.fit(train_data, train_target)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(test_target)</span><br><span class="line"><span class="built_in">print</span>(clf.predict(test_data))</span><br></pre></td></tr></table></figure>

<p>在运行下面代码之前,需要pip install pydot 和pip install six,pip install GraphViz。还有GraphViz软件,并修改PATH</p>
<p><a target="_blank" rel="noopener" href="https://graphviz.gitlab.io/_pages/Download/windows/graphviz-2.38.msi">graphviz-2.38.msi</a>，下载地址为<a target="_blank" rel="noopener" href="https://graphviz.gitlab.io/_pages/Download/Download_windows.html">https://graphviz.gitlab.io/_pages/Download/Download_windows.html</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> six <span class="keyword">import</span> StringIO <span class="comment">#制作PDF</span></span><br><span class="line"><span class="keyword">import</span> pydot</span><br><span class="line">dot_data = StringIO()</span><br><span class="line">tree.export_graphviz(clf, out_file=dot_data,</span><br><span class="line">                     feature_names=iris.feature_names,</span><br><span class="line">                     class_names=iris.target_names,</span><br><span class="line">                     filled=<span class="literal">True</span>, rounded=<span class="literal">True</span>,</span><br><span class="line">                     special_characters=<span class="literal">True</span>)</span><br><span class="line">graph = pydot.graph_from_dot_data(dot_data.getvalue())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(graph))  <span class="comment"># 1</span></span><br><span class="line"><span class="built_in">print</span>(graph)  <span class="comment"># [&lt;pydot.Dot object at 0x000001F7BD1A9630&gt;]</span></span><br><span class="line"><span class="built_in">print</span>(graph[<span class="number">0</span>])  <span class="comment"># &lt;pydot.Dot object at 0x000001F7BD1A9630&gt;</span></span><br><span class="line">graph[<span class="number">0</span>].write_pdf(<span class="string">&quot;iris.pdf&quot;</span>)<span class="comment">#默认工作路径,也可以更改到桌面之类的地方</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404112032.png" style="zoom: 50%;" />





<h2 id="何为优秀特征"><a href="#何为优秀特征" class="headerlink" title="何为优秀特征"></a>何为优秀特征</h2><p>有些特征会破坏分类器的准确性。比如狗的身高在一定范围内能预测狗的种类,但是狗的眼睛颜色就和狗的种类没有关系。</p>
<p>*np.random.randn()含义:</p>
<p>For random samples from N$(\mu, \sigma^2)$, use:</p>
<p>$\sigma$ * np.random.randn(…) + $\mu$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt<span class="comment">#导入库</span></span><br><span class="line"></span><br><span class="line">greyhounds=<span class="number">500</span><span class="comment">#数据规模</span></span><br><span class="line">labs=<span class="number">500</span></span><br><span class="line">grey_height=<span class="number">28</span>+<span class="number">4</span>*np.random.randn(greyhounds)<span class="comment">#灰猎狗的平均身高为28英寸,服从正态分布</span></span><br><span class="line">lab_height=<span class="number">24</span>+<span class="number">4</span>*np.random.randn(labs)<span class="comment">#生成训练数据</span></span><br><span class="line">plt.hist([grey_height,lab_height],stacked=<span class="literal">True</span>,color=[<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;g&#x27;</span>])<span class="comment">#展示直方图</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404165703.png" style="zoom: 33%;" />

<h2 id="让我们写一个机器学习流水线吧！-k近邻分类器"><a href="#让我们写一个机器学习流水线吧！-k近邻分类器" class="headerlink" title="让我们写一个机器学习流水线吧！(k近邻分类器)"></a>让我们写一个机器学习流水线吧！(k近邻分类器)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets<span class="comment">#导入数据集</span></span><br><span class="line">iris=datasets.load_iris()</span><br><span class="line">x=iris.data</span><br><span class="line">y=iris.target</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split<span class="comment">#生成训练集测试集</span></span><br><span class="line">x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=<span class="number">.5</span>)</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier<span class="comment">#训练K近邻分类器</span></span><br><span class="line">my_classifier=KNeighborsClassifier()</span><br><span class="line">my_classifier.fit(x_train,y_train)<span class="comment">#拟合</span></span><br><span class="line"></span><br><span class="line">predictions=my_classifier.predict(x_test)<span class="comment">#训练预测结果</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score<span class="comment">#计算训练精度</span></span><br><span class="line"><span class="built_in">print</span>(accuracy_score(y_test,predictions))<span class="comment">#输入测试集和预测集</span></span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200404172720.png" style="zoom: 67%;" />



<h2 id="我们的第一个分类器"><a href="#我们的第一个分类器" class="headerlink" title="我们的第一个分类器"></a>我们的第一个分类器</h2><p>自己编写一个分类器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets<span class="comment">#导入数据集</span></span><br><span class="line">iris=datasets.load_iris()</span><br><span class="line">x=iris.data</span><br><span class="line">y=iris.target</span><br><span class="line"><span class="comment">#用类来编写分类器</span></span><br><span class="line"><span class="keyword">from</span> scipy.spatial <span class="keyword">import</span> distance</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">euc</span>(<span class="params">a,b</span>):<span class="comment">#计算欧几里得距离</span></span><br><span class="line">    <span class="keyword">return</span> distance.euclidean(a,b)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ScrappyKNN</span>():<span class="comment">#自定义的KNN分类器</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">fit</span>(<span class="params">self,x_train,y_train</span>):</span><br><span class="line">        self.x_train=x_train</span><br><span class="line">        self.y_train=y_train</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">self,x_test</span>):</span><br><span class="line">        predictions=[]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> x_test:</span><br><span class="line">            label=self.closest(row)</span><br><span class="line">            predictions.append(label)</span><br><span class="line">        <span class="keyword">return</span> predictions</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">closest</span>(<span class="params">self,row</span>):<span class="comment">#n个最近邻</span></span><br><span class="line">        best_dist=euc(row,self.x_train[<span class="number">0</span>])</span><br><span class="line">        best_index=<span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(self.x_train)):</span><br><span class="line">            dist=euc(row,self.x_train[i])</span><br><span class="line">            <span class="keyword">if</span> dist&lt;best_dist:</span><br><span class="line">                best_dist=dist</span><br><span class="line">                best_index=i</span><br><span class="line">        <span class="keyword">return</span> self.y_train[best_index]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split<span class="comment">#生成训练集测试集</span></span><br><span class="line">x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=<span class="number">.5</span>)</span><br><span class="line"><span class="comment">#from sklearn.neighbors import KNeighborsClassifier#训练K近邻分类器</span></span><br><span class="line"><span class="comment">#my_classifier=KNeighborsClassifier()</span></span><br><span class="line">my_classifier=ScrappyKNN()</span><br><span class="line">my_classifier.fit(x_train,y_train)<span class="comment">#拟合</span></span><br><span class="line"></span><br><span class="line">predictions=my_classifier.predict(x_test)<span class="comment">#训练预测结果</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score<span class="comment">#计算训练精度</span></span><br><span class="line"><span class="built_in">print</span>(accuracy_score(y_test,predictions))<span class="comment">#输入测试集和预测集</span></span><br></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/fafaface/Picgo_Typora/master/icgo/20200405192724.png"></p>
<h2 id="使用TensorFlow-for-Poets-训练图像分类器"><a href="#使用TensorFlow-for-Poets-训练图像分类器" class="headerlink" title="使用TensorFlow for Poets 训练图像分类器"></a>使用TensorFlow for Poets 训练图像分类器</h2><p>需要pip install tensorflow 库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#貌似现在不支持了(x</span></span><br></pre></td></tr></table></figure>

<p>(弃坑)</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/m1luf0">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E5%A5%BD-%E4%B8%96%E7%95%8C-%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">1.</span> <span class="toc-text">你好,世界(决策树分类器)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96-%E9%B8%A2%E5%B0%BE%E8%8A%B1iris%E8%B5%84%E6%96%99%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">决策树的可视化(鸢尾花iris资料集)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%95%E4%B8%BA%E4%BC%98%E7%A7%80%E7%89%B9%E5%BE%81"><span class="toc-number">3.</span> <span class="toc-text">何为优秀特征</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E4%BB%AC%E5%86%99%E4%B8%80%E4%B8%AA%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%B5%81%E6%B0%B4%E7%BA%BF%E5%90%A7%EF%BC%81-k%E8%BF%91%E9%82%BB%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">让我们写一个机器学习流水线吧！(k近邻分类器)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E4%BB%AC%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">5.</span> <span class="toc-text">我们的第一个分类器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8TensorFlow-for-Poets-%E8%AE%AD%E7%BB%83%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB%E5%99%A8"><span class="toc-number">6.</span> <span class="toc-text">使用TensorFlow for Poets 训练图像分类器</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://m1luf0.github.io/2020/01/14/Google%20ML/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&text=Google机器学习讲座笔记"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&is_video=false&description=Google机器学习讲座笔记"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Google机器学习讲座笔记&body=Check out this article: https://m1luf0.github.io/2020/01/14/Google%20ML/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&title=Google机器学习讲座笔记"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://m1luf0.github.io/2020/01/14/Google%20ML/&name=Google机器学习讲座笔记&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://m1luf0.github.io/2020/01/14/Google%20ML/&t=Google机器学习讲座笔记"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2024
    m1luf0
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/m1luf0">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
